!function(a,b){(typeof define).match(/^(object|function)$/)&&define.amd?define(["angular","video.js"],b):"object"==typeof module&&module.exports?module.exports=b(require("angular"),require("video.js")):b(a.angular,a.videojs)}(this,function(a,b){"use strict";function c(){return b&&b.VERSION?b.VERSION:"0.0.0"}function d(){var a=0,b=/^(\d+)\./.exec(c());return b?(b&&b.length>=2&&(isNaN(b[1])||(a=Number(b[1]))),a):0}function e(a){return"VIDEO"===a[0].nodeName||"AUDIO"===a[0].nodeName}var f=a.module("vjs.video",[]),g=4;return f.controller("VjsVideoController",["$scope",function(c){function f(a,c){var d,f=null;if(!b)throw new Error("video.js was not found!");if(c){if(d=a[0].querySelectorAll("video, audio"),0===d.length)throw new Error("video tag must be defined within container directive!");if(d.length>1)throw new Error("only one video can be defined within the container directive!");f=d[0]}else{if(!e(a))throw new Error("directive must be attached to a video or audio tag!");f=a[0]}return f}function h(a,b){var c,d,e,f=b,g=document.createElement("style"),h=function(a){var b=a.split(":"),c='the ratio must either be "wide", "standard" or decimal values in the format of w:h';if(2!==b.length)throw new Error(c);if(isNaN(b[0])||isNaN(b[1]))throw new Error(c);if(0===Number(b[0])||0===Number(b[1]))throw new Error("neither the width or height ratio can be zero!");return Number(b[1])/Number(b[0])*100},i=function(a){var b,c=a[0].querySelector(".vjs-tech");if(!c)throw new Error("Failed to find instance of video-js class!");return b="vjs-container-"+c.getAttribute("id"),a[0].setAttribute("id",b),b};switch(f||(f="16:9"),f){case"wide":f="16:9";break;case"standard":f="4:3"}c=i(a),d=h(f),e=["#",c," ",".video-js {padding-top:",d,"%;}\n",".vjs-fullscreen {padding-top: 0px;}"].join(""),g.type="text/css",g.rel="stylesheet",g.styleSheet?g.styleSheet.cssText=e:g.appendChild(document.createTextNode(e)),a[0].appendChild(g)}function i(a,b){var c,d,e="a sources and/or tracks element must be defined for the vjs-media attribute",f="sources must be an array of objects with at least one item",g="tracks must be an array of objects with at least one item";if(a.vjsMedia){if(!a.vjsMedia.sources&&!a.vjsMedia.tracks)throw new Error(e);if(a.vjsMedia.sources&&!(a.vjsMedia.sources instanceof Array))throw new Error(f);if(a.vjsMedia.tracks&&!(a.vjsMedia.tracks instanceof Array))throw new Error(g);c=document.createElement("div"),a.vjsMedia.sources&&a.vjsMedia.sources.forEach(function(a){d=document.createElement("source"),d.setAttribute("src",a.src||""),d.setAttribute("type",a.type||""),c.appendChild(d)}),a.vjsMedia.tracks&&a.vjsMedia.tracks.forEach(function(a){d=document.createElement("track"),d.setAttribute("kind",a.kind||""),d.setAttribute("label",a.label||""),d.setAttribute("src",a.src||""),d.setAttribute("srclang",a.srclang||""),a["default"]===!0&&d.setAttribute("default",""),c.appendChild(d)}),b.call(void 0,{element:c})}}function j(f,j,k,l){var m,n=j.vjsSetup||{},o=j.vjsRatio,p=!e(k)&&d()<=g?!0:!1;if(!b)return null;j.vjsMedia&&j.vjsMedia.poster&&(n.poster=j.vjsMedia.poster),i(j,l),m=c.$watch(function(){return j.vjsMedia},function(d,e){d&&!a.equals(d,e)&&(m(),p?(b(f).dispose(),c.$emit("vjsVideoMediaChanged")):c.$emit("vjsVideoMediaChanged"))});var q=b(f,n,function(){p&&h(k,o)});q&&c.$emit("vjsVideoReady",{id:f.getAttribute("id"),vid:q,player:q,controlBar:q.controlBar}),c.$on("$destroy",function(){b(f).dispose()})}var k=this;k.initVideoJs=j,k.getVidElement=f}]),f.directive("vjsVideo",["$compile","$timeout",function(a,b){return{restrict:"A",transclude:!0,scope:{vjsSetup:"=?",vjsRatio:"@",vjsMedia:"=?"},controller:"VjsVideoController",controllerAs:"vjsCtrl",bindToController:!0,link:function(c,e,f,h,i){var j,k,l,m,n=function(a){e.children().remove(),e.append(a.element.childNodes)},o=function(){j=h.getVidElement(e),d()>g&&h.vjsRatio&&(h.vjsSetup||(h.vjsSetup={}),h.vjsSetup.aspectRatio=h.vjsRatio),i(function(a){e.append(a),h.initVideoJs(j,h,e,n)})};l=e.clone(),e.parent().hasClass("vjs-video-wrap")||e.wrap('<div class="vjs-video-wrap"></div>'),k=e.parent(),c.$on("vjsVideoMediaChanged",function(){var d=k.children()[0];b(function(){c.$destroy()}),m=l.clone(),k.append(m),m=a(m)(c.$parent),d.remove()}),o()}}}]),f.directive("vjsVideoContainer",[function(){return{restrict:"AE",transclude:!0,template:'<div class="vjs-directive-container"><div ng-transclude></div></div>',scope:{vjsSetup:"=?",vjsRatio:"@",vjsMedia:"=?"},controller:"VjsVideoController",controllerAs:"vjsCtrl",bindToController:!0,link:function(a,b,c,e,f){var h,i,j=function(a){var c=b[0].querySelector("video, audio");if(c){for(;c.firstChild;)c.removeChild(c.firstChild);for(;a.element.childNodes.length>0;)c.appendChild(a.element.childNodes[0])}},k=function(){if(h=e.getVidElement(b,!0),null!==h.getAttribute("vjs-video"))throw new Error("vjs-video should not be used on the video tag when using vjs-video-container!");if(null!==h.getAttribute("vjs-setup")||null!==h.getAttribute("vjs-media")||null!==h.getAttribute("vjs-ratio"))throw new Error("directive attributes should not be used on the video tag when using vjs-video-container!");d()>g?e.vjsRatio&&(e.vjsSetup||(e.vjsSetup={}),e.vjsSetup.aspectRatio=e.vjsRatio):(h.setAttribute("width","auto"),h.setAttribute("height","auto")),e.initVideoJs(h,e,b,j)};f(function(a){i=a.clone()}),a.$on("vjsVideoMediaChanged",function(){b.children().remove(),b.append(i.clone()),k()}),k()}}}]),f});